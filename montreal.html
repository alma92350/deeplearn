<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<script src="montreal_files/deeplearnlatest.js"></script>

<script> // Fit a quadratic function by learning the coefficients a, b, c.
const xs = dl.tensor1d([0, 1, 2, 3]);
const ys = dl.tensor1d([1.1, 5.9, 16.8, 33.9]);

const a = dl.variable(dl.scalar(Math.random()));
const b = dl.variable(dl.scalar(Math.random()));
const c = dl.variable(dl.scalar(Math.random()));

// y = a * x^2 + b * x + c.
const f = x => a.mul(x.square()).add(b.mul(x)).add(c);
const loss = (pred, label) => pred.sub(label).square().mean();

const learningRate = 0.01;
const optimizer = dl.train.sgd(learningRate);

// Train the model.
for (let i = 0; i < 1001; i++) {
   err = optimizer.minimize(() => loss(f(xs), ys),true);
   if(i%100 ===0) err.data().then(data => console.log(data));;
}

// Make predictions.
console.log(
     `a: ${a.dataSync()}, b: ${b.dataSync()}, c: ${c.dataSync()}`);
const preds = f(xs).dataSync();
preds.forEach((pred, i) => {
   console.log(`x: ${i}, pred: ${pred}`);
}); </script>    
</head>

<body>
    hello


</body></html>